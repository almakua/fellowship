---
# =============================================================================
# Variabili globali per tutto il cluster
# =============================================================================

# Dominio interno
internal_domain: mb.home

# Dominio pubblico per Let's Encrypt
public_domain: mbianchi.me

# Timezone
timezone: Europe/Rome

# Locale
locale: en_US.UTF-8

# =============================================================================
# NFS Configuration
# =============================================================================
nfs_server: aragorn
nfs_server_ip: "{{ hostvars['aragorn']['ansible_host'] }}"
nfs_export_path: /srv/nfs/k3s
nfs_export_options: "rw,sync,no_subtree_check,no_root_squash"

# =============================================================================
# K3s Configuration
# =============================================================================
k3s_version: v1.31.2+k3s1  # Ultima stabile, aggiorna se necessario

# Master node
k3s_master_ip: "{{ hostvars['aragorn']['ansible_host'] }}"
k3s_master_hostname: aragorn

# Flannel backend
k3s_flannel_backend: vxlan

# ServiceLB IP range
k3s_servicelb_range: "192.168.1.201-192.168.1.240"

# ServiceLB disabilitato (usiamo nginx esterno)
k3s_disable:
  - servicelb

# =============================================================================
# Cloudflare (per cert-manager DNS challenge)
# =============================================================================
cloudflare_email: ""  # TODO: inserisci la tua email Cloudflare
# Il token API va in vault o come variabile d'ambiente
# cloudflare_api_token: from vault or env

# =============================================================================
# Addons versions
# =============================================================================
helm_version: v3.16.2
cert_manager_version: v1.16.2
argocd_chart_version: "7.7.5"  # Chart version, NOT app version

# Prometheus stack (via helm chart)
kube_prometheus_stack_version: 66.2.1

# =============================================================================
# Tailscale DNS Configuration
# =============================================================================
# Per risolvere domini pubblici con CNAME verso Tailscale

tailscale_dns: "100.100.100.100"
fallback_dns: "8.8.8.8"

# Entry statiche per domini con CNAME verso Tailscale
# Aggiungi qui tutti i domini pubblici che puntano a indirizzi Tailscale
tailscale_hosts:
  - ip: "100.120.136.89"  # aragorn Tailscale IP
    hostnames:
      - "status.mbianchi.me"
      - "aragorn.alpaca-scala.ts.net"
      - "argocd.mbianchi.me"
      - "grafana.mbianchi.me"
      - "prometheus.mbianchi.me"
      - "jellyfin.mbianchi.me"
      - "radarr.mbianchi.me"
      - "sonarr.mbianchi.me"
      - "qbittorrent.mbianchi.me"
      - "lidarr.mbianchi.me"
      - "prowlarr.mbianchi.me"
      - "ntfy.mbianchi.me"
      - "bazarr.mbianchi.me"
      - "homepage.mbianchi.me"
      - "jellyseerr.mbianchi.me"
  # Aggiungi altri come necessario:
  # - ip: "100.x.x.x"
  #   hostnames:
  #     - "altro.mbianchi.me"

